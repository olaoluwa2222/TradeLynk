# ============================================
# Server Configuration
# ============================================
server:
  address: 0.0.0.0
  port: 8080
  servlet:
    context-path: /api/v1




# ============================================
# Spring Configuration
# ============================================
spring:
  application:
    name: tradeLynkApi


  flyway:
    enabled: true
    baseline-on-migrate: true
    baseline-version: 0
    locations: classpath:db/migration


  mail:
    host: smtp.gmail.com
    port: 587
    username: ${EMAIL_USERNAME}
    password: ${EMAIL_APP_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

  config:
    import: optional:file:.env[.properties]
  
  # PostgreSQL Database Configuration
  datasource:
    url: jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=require
    username: ${DB_USER}
    password: ${DB_PASS}
    driver-class-name: org.postgresql.Driver

    # HikariCP Connection Pool Configuration
    hikari:
      maximum-pool-size: 5
      minimum-idle: 2
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      # SSL Configuration for Supabase (CRITICAL!)
      data-source-properties:
        ssl: true
        sslmode: require
  
  # JPA/Hibernate Configuration
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

# ============================================
# JWT Configuration
# ============================================
# Generate a strong secret key: base64 ejwt:
#  secret: ${JWT_SECRET}
#  expiration: ${JWT_EXPIRATION}
#  refresh-expiration: ${JWT_REFRESH_EXPIRATION}ncoded minimum 256 bits (32 bytes)
# You can generate one with: echo $(head -c 32 /dev/urandom | base64)
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION}
  refresh-expiration: ${JWT_REFRESH_EXPIRATION}

# ============================================
# Firebase Configuration
# ============================================
firebase:
  credentials-path: ${FIREBASE_CREDENTIALS_PATH}
  database-url: ${FIREBASE_DATABASE_URL}

# ============================================
# Cloudinary Configuration
# ============================================
cloudinary:
  cloud-name: ${CLOUDINARY_CLOUD_NAME}
  api-key: ${CLOUDINARY_API_KEY}
  api-secret: ${CLOUDINARY_API_SECRET}
  upload-folder: tradelynk-markectplace

# ============================================
# Paystack Configuration
# ============================================
paystack:
  secret-key: ${PAYSTACK_SECRET_KEY}
  public-key: ${PAYSTACK_PUBLIC_KEY}
  api-url: https://api.paystack.co
  timeout: 30000  # 30 seconds in milliseconds

# ============================================
# Resend Configuration
# ============================================
resend:
  api:
    key: ${RESEND_API_KEY}

# ============================================
# Application Configuration
# ============================================
app:
  name: Campus Marketplace
  version: 1.0.0
  university-domain: lmu.edu.ng
  frontend:
    url: http://localhost:3000

# ============================================
# Logging Configuration
# ============================================
logging:
  level:
    root: INFO
    com.codewithola.tradelynkapi: DEBUG
    org.springframework.security: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"


# ============================================
# CORS Configuration
# ============================================

# PHASE 1: Postman Testing Only (Current Stage)
cors:
  allowed-origins: http://localhost:3000,http://192.168.137.1:3000,http://localhost:8080,https://poststernal-pericarditic-torri.ngrok-free.dev,https://expressed-ways-bunch-chen.trycloudflare.com
  allow-credentials: true
  max-age: 3600

# PHASE 2: When you start Next.js frontend (Uncomment this, comment Phase 1)
# cors:
#   allowed-origins: http://localhost:3000,http://localhost:8080
#   allow-credentials: true
#   max-age: 3600

# PHASE 3: Production (Uncomment this, comment others)
# cors:
#   allowed-origins: https://yourdomain.com,https://api.yourdomain.com
#   allow-credentials: true
#   max-age: 86400